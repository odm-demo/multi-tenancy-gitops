resources:
# Db2 Operator
# - argocd/operators/ibm-cp4a-db2.yaml
# DB2 Instance
# - argocd/instances/ibm-cp4a-db2ucluster.yaml
# Openldap demonset/deployment
# - argocd/instances/ibm-cp4a-openldap-odm.yaml
# CP4A operator
# - argocd/operators/ibm-cp4a-odm-operator.yaml
# ODM Instance
# - argocd/instances/ibm-cp4a-icp4acluster.yaml

patches:
- target:
    group: argoproj.io
    kind: Application
    labelSelector: "gitops.tier.layer=services,gitops.tier.source=git"
  patch: |-
    - op: add
      path: /spec/source/repoURL
      value: ${GIT_BASEURL}/${GIT_ORG}/${GIT_GITOPS_SERVICES}
    - op: add
      path: /spec/source/targetRevision
      value: ${GIT_GITOPS_SERVICES_BRANCH}
- target:
    group: argoproj.io
    kind: Application
    labelSelector: "gitops.tier.layer=applications,gitops.tier.source=git"
  patch: |-
    - op: add
      path: /spec/source/repoURL
      value: ${GIT_BASEURL}/${GIT_ORG}/${GIT_GITOPS_APPLICATIONS}
    - op: add
      path: /spec/source/targetRevision
      value: ${GIT_GITOPS_APPLICATIONS_BRANCH}
- target:
    group: argoproj.io
    kind: Application
    labelSelector: "gitops.tier.layer=services,gitops.tier.source=helm"
  patch: |-
    - op: add
      path: /spec/source/repoURL
      value: ${HELM_REPOURL}
- target:
    name: ibm-automation-foundation-operator
  patch: |-
    - op: add
      path: /spec/source/helm/parameters/-
      value:
        name: spec.channel
        value: v1.1
